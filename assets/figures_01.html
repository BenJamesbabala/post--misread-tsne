

<div class="original">
  <span class="caption">Original</span>
  <canvas class="tsne-plot"></canvas>
  <button class="play">Play</button>
</div>
<div class="runners">
</div>


<script>
(function() {
  var dis = d3.select("#figures-01")
  var dataset = "Two Clusters"
  var demo = demosByName[dataset];
  var params = [50, 2]
  var examples = [
    { perplexity: 2, epsilon: 10, dim: 2 },
    { perplexity: 5, epsilon: 10, dim: 2 },
    { perplexity: 30, epsilon: 10, dim: 2 },
    { perplexity: 50, epsilon: 10, dim: 2 },
    { perplexity: 100, epsilon: 10, dim: 2 },
  ]
  // original
  var originalCanvas = dis.select(".original .tsne-plot")
    .style("width", FIGURES.width + "px")
    .style("height", FIGURES.height + "px")
    .attr("width", FIGURES.downscaleWidth + "px")
    .attr("height", FIGURES.downscaleHeight + "px")
    .node();
  var originalPoints = getPoints(demo, params)
  visualize(originalPoints, originalCanvas, null, null)

  // examples
  var runners = dis.select(".runners").selectAll("div.runner").data(examples)
    .enter().append("div").classed("runner", true)

  runners.append("span").classed("caption", true)
  .text(function(d) { return "Perplexity = " + d.perplexity})
  runners.append("canvas")
    .style("width", FIGURES.width + "px")
    .style("height", FIGURES.height + "px")
    .attr("width", FIGURES.downscaleWidth + "px")
    .attr("height", FIGURES.downscaleHeight + "px")
    .each(function(d) {
      var canvas = this;
      //var points = getPoints(demo, params)
      visualize(originalPoints, canvas)
    })

  runners.append("br")
  runners.append("span").classed("caption", true).classed("step", true).text("Step 0")

  dis.select(".original a.play").on("click", function() {
    dis.select(".runners").selectAll("div.runner").each(function(d) {
      var stepper = d3.select(this).select("span.step")
      stepper
        .text('Step 0')
        .classed("done", false)

      var canvas = d3.select(this).select("canvas").node();
      //var points = getPoints(demo, params)
      var stepCb = function(step) {
        stepper.text('Step ' + step)
      }
      var doneCb = function() {
        stepper.classed("done", true)
      }
      var runner = runDemo(originalPoints, canvas, d, 5000, stepCb, doneCb);
      // enable us to pause a demo
      d.runner = runner;
    })
  })

})()
</script>
